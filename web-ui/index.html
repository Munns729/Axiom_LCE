<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Axiom LCE - Contract Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        #contractText {
            min-height: 200px;
        }

        #playbook {
            min-height: 100px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            text-align: center;
            display: none;
        }

        #status.loading {
            background: #fff3cd;
            color: #856404;
            display: block;
        }

        #status.success {
            background: #d4edda;
            color: #155724;
            display: block;
        }

        #status.error {
            background: #f8d7da;
            color: #721c24;
            display: block;
        }

        #results {
            margin-top: 20px;
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }

        .warning-high {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .warning-title {
            font-weight: bold;
            color: #721c24;
            margin-bottom: 8px;
        }

        .warning-snippet {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.05);
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 13px;
        }

        .warning-remediation {
            color: #155724;
            margin-top: 8px;
            font-weight: 500;
        }

        .no-warnings {
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
        }

        .example-link {
            color: #667eea;
            cursor: pointer;
            text-decoration: underline;
            font-size: 14px;
        }

        .example-link:hover {
            color: #764ba2;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>‚öñÔ∏è Axiom LCE</h1>
            <p>The IDE for Transactions - Verify contract logic against commercial intent</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>üìÑ Contract Text</h2>
                <textarea id="contractText" placeholder="Paste your contract text here..."></textarea>
                <div style="margin-top: 10px;">
                    <span class="example-link" onclick="loadExample()">Load example contract</span>
                </div>
            </div>

            <div class="section">
                <h2>üìã Playbook (JSON)</h2>
                <textarea id="playbook">{
  "governing_law": "New York"
}</textarea>
            </div>

            <button onclick="analyzeContract()">üîç Verify Logic</button>

            <div id="status"></div>
            <div id="results"></div>
        </div>
    </div>

    <script>
        function loadExample() {
            document.getElementById('contractText').value = `CONSULTING AGREEMENT

This Agreement is entered into between Company A ("Client") and Company B ("Consultant").

SERVICES
The Consultant shall provide software development services as described in Exhibit A.

PAYMENT TERMS
Payment shall be made within 30 days of invoice receipt.

GOVERNING LAW
This Agreement shall be governed by and construed in accordance with the laws of the State of Delaware, without regard to its conflict of law provisions.

TERMINATION
Either party may terminate this Agreement with 30 days written notice.`;
        }

        async function analyzeContract() {
            const contractText = document.getElementById('contractText').value;
            const playbookText = document.getElementById('playbook').value;
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');

            if (!contractText.trim()) {
                statusDiv.className = 'error';
                statusDiv.textContent = 'Please enter contract text';
                return;
            }

            // Parse playbook
            let playbook;
            try {
                playbook = JSON.parse(playbookText);
            } catch (e) {
                statusDiv.className = 'error';
                statusDiv.textContent = 'Invalid JSON in playbook';
                return;
            }

            // Show loading
            statusDiv.className = 'loading';
            statusDiv.textContent = 'Analyzing contract...';
            resultsDiv.innerHTML = '';

            // Create form data
            const formData = new FormData();
            formData.append('file', new Blob([contractText], { type: 'text/plain' }), 'contract.txt');
            formData.append('playbook', JSON.stringify(playbook));

            try {
                const response = await fetch('http://localhost:3000/analyze_logic', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                statusDiv.className = 'success';
                statusDiv.textContent = `Analysis complete! Contract ID: ${data.contract_id}`;

                // Display results
                if (data.warnings && data.warnings.length > 0) {
                    let html = '<h2 style="color: #721c24; margin-bottom: 15px;">‚ö†Ô∏è Warnings Found</h2>';
                    data.warnings.forEach(warning => {
                        const severityClass = warning.severity === 'High' ? 'warning-high' : '';
                        html += `
                            <div class="warning ${severityClass}">
                                <div class="warning-title">${warning.issue}</div>
                                <div style="font-size: 14px; color: #666;">Severity: ${warning.severity}</div>
                                <div class="warning-snippet">${warning.text_snippet}</div>
                                <div class="warning-remediation">üí° ${warning.remediation}</div>
                            </div>
                        `;
                    });
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = '<div class="no-warnings">‚úÖ No conflicts detected - document matches playbook!</div>';
                }

            } catch (error) {
                statusDiv.className = 'error';
                statusDiv.textContent = `Error: ${error.message}. Make sure the server is running on http://localhost:3000`;
                console.error(error);
            }
        }

        // Load example on page load
        window.onload = () => {
            loadExample();
        };
    </script>
</body>

</html>